@page "/Users"

<h3>Hello Users!</h3>


<a class="waves-effect waves-light btn" href="/users/new">Add new user</a>


<div>
    <SearchPanel OnSearch="Search" />
</div>

@if (users is null)
{
    <ProgressBar>
        <em>Loading users...</em>
    </ProgressBar>
}
else
{
    <EntityTableTemplate Entities="users">
        <HeaderTemplate>
            <th>First name</th>
            <th>Last name</th>
            <th>Email</th>
        </HeaderTemplate>
        <RowTemplate Context="user">
            <td>@user.FirstName</td>
            <td>@user.LastName</td>
            <td>@user.Email</td>
        </RowTemplate>
    </EntityTableTemplate>
}

@code {

    private async Task Search(string searchText)
    {
        var searchCriteria = new UserSearchCriteria { FirstName = searchText };

        users = await Api.GetBySearchCriteriaAsync(searchCriteria);
    }

}